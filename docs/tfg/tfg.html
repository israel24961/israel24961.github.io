<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li:not(:nth-child(2)) > a, .site-nav > ul.nav-list:first-child > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>TFG</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="TFG" /> <meta property="og:locale" content="en_US" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="TFG" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"TFG","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/img/monkey.gif"}},"url":"/docs/tfg/tfg.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label=""></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in TFG category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/tfg/tfg.html" class="nav-list-link">TFG</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/tfg/roadmap.html" class="nav-list-link">Roadmap</a></li><li class="nav-list-item"><a href="/docs/tfg/roadmap_2.html" class="nav-list-link">Roadmap_2-Voronoi_Cells</a></li><li class="nav-list-item"><a href="/docs/tfg/conclusions.html" class="nav-list-link">Conclusions</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in chatbot category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/chatbot/chatbot.html" class="nav-list-link">chatbot</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/chatbot/gpt4.html" class="nav-list-link">open ai's gpt</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in routing category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/routing/routing.html" class="nav-list-link">routing</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/routing/routing_roadmap.html" class="nav-list-link">routing roadmap</a></li></ul></li><li class="nav-list-item"><a href="/docs/DroneWorld/droneworld.html" class="nav-list-link">A simple project?</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search" aria-label="Search" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <p class="label">Last Modified: 2023-Jun-29</p> <h1 class="no_toc" id="intro-roadmap"> <a href="#intro-roadmap" class="anchor-heading" aria-labelledby="intro-roadmap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> INTRO Roadmap </h1> <h1 class="no_toc text-delta" id="índice"> <a href="#índice" class="anchor-heading" aria-labelledby="índice"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Índice </h1> <ol id="markdown-toc"> <li><a href="#objective" id="markdown-toc-objective">Objective</a></li> <li><a href="#steps" id="markdown-toc-steps">Steps</a> <ol> <li><a href="#roads" id="markdown-toc-roads">Roads</a> <ol> <li><a href="#example-of-filtered-data-and-non-filtered-data" id="markdown-toc-example-of-filtered-data-and-non-filtered-data">Example of filtered data and non filtered data</a></li> <li><a href="#characterizing-roads-congestion" id="markdown-toc-characterizing-roads-congestion">Characterizing roads’ congestion</a></li> </ol> </li> <li><a href="#graph-representation" id="markdown-toc-graph-representation">Graph representation</a> <ol> <li><a href="#joining-uber-and-osm-data" id="markdown-toc-joining-uber-and-osm-data">Joining uber and osm data</a></li> <li><a href="#some-representations" id="markdown-toc-some-representations">Some representations</a></li> </ol> </li> <li><a href="#cell-network-next-page" id="markdown-toc-cell-network-next-page">Cell network (next page)</a></li> </ol> </li> </ol><hr /> <h1 id="objective"> <a href="#objective" class="anchor-heading" aria-labelledby="objective"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Objective </h1> <p>To Develop a Python environment, based on the NetworkX library, in order to study route planning algorithms in a scenario of remote driving with <em>real</em> environments. The overall goal is to minimize the number of cells required to perform a remote drive, in order to maximize the number of hypothetical cars/travels that can be performed at the same time.</p> <p>The main milestones are:</p> <ol> <li><a href="#roads">Roads:</a> Obtain realistic road data <ul> <li>Speed data</li> </ul> </li> <li><a href="#graph-representation">Graph representation:</a> of the roads</li> <li>Base Stations: Obtain realistic data of base stations’ positions]</li> <li>Create a graph of base stations</li> <li>Find the shortest path between two base stations</li> <li>Implement a 2 layer routing algorithm</li> <li>Analyze the results</li> </ol> <p><img src="/img/2_networkx_logo.png" alt="" width="30%" /> <img src="/img/3_osm_logo.png" alt="" width="30%" /></p> <h1 id="steps"> <a href="#steps" class="anchor-heading" aria-labelledby="steps"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Steps </h1> <h2 id="roads"> <a href="#roads" class="anchor-heading" aria-labelledby="roads"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Roads </h2> <p>Using <a href="https://overpass-turbo.eu/">Overpass</a>, <a href="https://wiki.openstreetmap.org/wiki/API_v0.6">OSM’s API</a>, we can obtain data of the roads in a certain area, for example, the center of Madrid.</p> <p><img src="/img/osm_rawmap.png" alt="" width="60%" /></p> <p>Overpass’s queries have their own language (Overpass QL) somewhat like SQL, but for interacting with OSM’s API. This can be easily learned by using the <a href="https://overpass-turbo.eu/">Overpass Turbo</a> web interface and following the <a href="https://osm-queries.ldodds.com/tutorial/">ldodds’ tutorial</a>.</p> <p>As a summary, some of the main objects in the query are <code class="language-plaintext highlighter-rouge">way</code> and <code class="language-plaintext highlighter-rouge">node</code>, which are the main objects to define roads and intersections, respectively.</p> <p>Defining a bounding box <code class="language-plaintext highlighter-rouge">bbox</code> or a center and radious <code class="language-plaintext highlighter-rouge">around</code>, we can obtain the data of the roads in that area. Further filtering can be accomplished by using <a href="https://wiki.openstreetmap.org/wiki/Tags">tags</a>, due to the fact that the data is user generated, the quality of the data can vary, hence roads with similar characteristics can differ in the tags they have. Luckily I some tags from <a href="https://github.com/Project-OSRM/osrm-backend/blob/master/profiles/car.lua">Project-OSRM</a> and added another tags that appear in the roads I was interested in.</p> <h3 id="example-of-filtered-data-and-non-filtered-data"> <a href="#example-of-filtered-data-and-non-filtered-data" class="anchor-heading" aria-labelledby="example-of-filtered-data-and-non-filtered-data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example of filtered data and non filtered data </h3> <p><img src="/img/osm_nofiltered.png" alt="" width="35%" /> <img src="/img/osm_filtered.png" alt="" width="35%" /></p> <p><strong>Note: There are tags like direction, lanes, maxspeed, name, oneway, surface, width and many more.</strong></p> <h3 id="characterizing-roads-congestion"> <a href="#characterizing-roads-congestion" class="anchor-heading" aria-labelledby="characterizing-roads-congestion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Characterizing roads’ congestion </h3> <p>From <a href="https://movement.uber.com/">UberMovement</a> we can obtain data of the roads’ congestion, understood as the average speed of the cars that pass through that road. This data lists roads’s average speed per hour, per day, per month, per year. Although not every road has data for every hour, it’s still a good approximation of the road’s congestion.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Field</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>year</td> <td>-</td> </tr> <tr> <td>month</td> <td>-</td> </tr> <tr> <td>day</td> <td>-</td> </tr> <tr> <td>hour</td> <td>-</td> </tr> <tr> <td>osm_way_id</td> <td>UID of the road section (way) in OSM</td> </tr> <tr> <td>osm_start_node_id</td> <td>UID of the start node of the way</td> </tr> <tr> <td>osm_end_node_id</td> <td>UID of the end node of the way</td> </tr> <tr> <td>speed_kph_mean</td> <td>-</td> </tr> <tr> <td>speed_kph_stddev</td> <td>-</td> </tr> </tbody> </table></div> <p><img src="/img/example_via1.png" alt="" width="40%" /> <img src="/img/example_via2.png" alt="" width="40%" /></p> <p><strong>I will just use the mean speed and put the data into an SQL DB.</strong></p> <h2 id="graph-representation"> <a href="#graph-representation" class="anchor-heading" aria-labelledby="graph-representation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Graph representation </h2> <p>For network analysis, we can represent the roads as a graph, where the nodes are the intersections and the edges are the roads. To treat this data in graph form, it’s loaded into a <a href="https://networkx.org/documentation/stable/reference/classes/index.html">Networkx</a> graph. NetworkX is a library that facilitates the creation, manipulation, and study of the structure, dynamics, and functions of complex networks. I will use Dijkstra and A* algorithms to find the shortest path between two nodes.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import networkx as nx
Graph=nx.Graph()
ways_nodes=queryOSM(lat,long)
Graph.add_edges_from(ways_nodes)
...
ShortestPath=nx.dijkstra_path(Graph,node_start,node_end) # Array de nodos
...
paint(Graph)
paint(ShortestPath)
</code></pre></div></div> <p><img src="/img/networkx_graphShortest.png" alt="" width="80%" /></p> <h3 id="joining-uber-and-osm-data"> <a href="#joining-uber-and-osm-data" class="anchor-heading" aria-labelledby="joining-uber-and-osm-data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Joining uber and osm data </h3> <p>In Networkx, the vertices or <code class="language-plaintext highlighter-rouge">edges</code> are added as 3-tuples <code class="language-plaintext highlighter-rouge">(u,v,data)</code>, <code class="language-plaintext highlighter-rouge">data</code> is a dictionary with arbitrary information, which we want to access later, for example, during the search for the shortest path or when representing <code class="language-plaintext highlighter-rouge">paint</code> the graph. In <code class="language-plaintext highlighter-rouge">data['speed']</code> the “current” speed is saved:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import networkx as nx
Graph=nx.Graph()
ways_nodes=queryOSM(lat,long)
Graph.add_edges_from(ways_nodes) #  Roards as gaphs
ubermv.updatespeed(Graph,hora=9,dia=Friday) # Update the speed of the roads
...
ShortestPath=nx.dijkstra_path(Graph,node_start,node_end) # Array de nodos
...
paint(Graph)
paint(ShortestPath)
</code></pre></div></div> <h3 id="some-representations"> <a href="#some-representations" class="anchor-heading" aria-labelledby="some-representations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Some representations </h3> <ol> <li> <p>Roads with their’s widths and colors as their average speed (greener and thicker is faster) and the shortest path in yellow.</p> <p><img src="/img/example_colors_1.png" alt="" width="60%" /></p> </li> <li> <p>Speeds in the shortest path.</p> <p><img src="/img/example_colors_2.png" alt="" width="60%" /></p> </li> <li> <p>Gif of the shortest path (Dijkstra) throughout the day</p> <p><img src="/img/updated_speed_resolution.gif" alt="" width="60%" /></p> </li> </ol> <h2 id="cell-network-next-page"> <a href="#cell-network-next-page" class="anchor-heading" aria-labelledby="cell-network-next-page"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cell network (next page) </h2> <p><a href="/docs/tfg/roadmap.html">Cells</a></p> <hr> <h2 class="text-delta">Table of contents</h2> <ul> <li> <a href="/docs/tfg/roadmap.html">Roadmap</a> </li> <li> <a href="/docs/tfg/roadmap_2.html">Roadmap_2-Voronoi_Cells</a> </li> <li> <a href="/docs/tfg/conclusions.html">Conclusions</a> </li> </ul> </main> <hr> <footer> <em> <small>"... and then, all you've coded will be lost, like tears in the rain"<small> <em> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
